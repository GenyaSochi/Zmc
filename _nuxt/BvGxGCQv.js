import{_ as C}from"./CDeO-3gr.js";import{g as T,ag as D,r as u,s as M,M as h,w as B,o as d,ah as P,c as v,E as S,a as e,D as b,G as g,H as y,I as k,t as z,d as E}from"#entry";import{_ as I}from"./DlAUqK2U.js";const N={class:"window"},q={class:"input-group"},F=["disabled"],O={class:"input-group"},U=["disabled"],W=["disabled"],G={key:0},H={key:1,class:"loader"},L=T({__name:"ModalComponent",props:{modelValue:{default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(w){const _=D(w,"modelValue"),i=u(""),n=u(""),t=u(""),l=u(!1),c=u(!1),o=u(!1),f=M(()=>i.value.trim().length>=2&&n.value.replace(/\D/g,"").length>=11),$=r=>{let s=r.target.value.replace(/\D/g,"");(s.startsWith("7")||s.startsWith("8"))&&(s=s.substring(1)),s.length>0&&(s="+7 "+s.substring(0,10).replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,"($1) $2-$3-$4").replace(/(\d{3})(\d{3})(\d{2})/,"($1) $2-$3").replace(/(\d{3})(\d{3})/,"($1) $2").replace(/(\d{3})/,"($1")),n.value=s},p=()=>{_.value=!1,x()},x=()=>{setTimeout(()=>{i.value="",n.value="",t.value="",l.value=!1,c.value=!1,o.value=!1},300)},V=async()=>{if(!(!f.value||l.value)){l.value=!0,t.value="",c.value=!1,o.value=!1;try{const r=n.value.replace(/\D/g,"").replace(/^7/,""),a=await $fetch("/api/orders/call",{method:"POST",body:{name:i.value.trim(),phone:r}});c.value=a.ok,o.value=!a.ok,t.value=a.message,a.ok?setTimeout(()=>{p()},3e3):setTimeout(()=>{t.value="",o.value=!1},5e3)}catch{o.value=!0,t.value="Ошибка отправки. Попробуйте позже.",setTimeout(()=>{t.value="",o.value=!1},5e3)}finally{l.value=!1}}};return(r,a)=>{const s=C;return d(),h(s,null,{default:B(()=>[(d(),h(P,{to:"body"},[_.value?(d(),v("div",{key:0,class:"windowpos",onClick:b(p,["self"])},[e("div",N,[e("div",{class:"window-header"},[a[2]||(a[2]=e("p",{class:"form"},"Форма обратной связи",-1)),e("button",{class:"close-btn",onClick:p,"aria-label":"Закрыть"}," × ")]),e("form",{onSubmit:b(V,["prevent"]),class:"form-container"},[e("div",q,[g(e("input",{class:"name",type:"text",id:"name",name:"name","onUpdate:modelValue":a[0]||(a[0]=m=>i.value=m),required:"",placeholder:"Ваше имя",disabled:l.value},null,8,F),[[y,i.value]])]),e("div",O,[g(e("input",{class:"phone",type:"tel",id:"phone",name:"phone","onUpdate:modelValue":a[1]||(a[1]=m=>n.value=m),required:"",placeholder:"+7 (___) ___-__-__",disabled:l.value,onInput:$},null,40,U),[[y,n.value]])]),e("button",{type:"submit",class:k(["butwindow",{"butwindow--loading":l.value}]),disabled:l.value||!f.value},[l.value?(d(),v("span",H)):(d(),v("span",G,"отправить запрос"))],10,W),e("p",{class:k(["mess",{"mess--success":c.value,"mess--error":o.value}])},z(t.value),3),a[3]||(a[3]=e("div",{class:"contacts-info"},[e("a",{href:"mailto:sales@zmkural.com",class:"info"},"sales@zmkural.com"),e("p",{class:"privacy"},[E(" Нажимая кнопку, вы соглашаетесь с "),e("a",{href:"/privacy",target:"_blank",class:"privacy-link"},"политикой конфиденциальности")])],-1))],32)])])):S("",!0)]))]),_:1})}}}),K=I(L,[["__scopeId","data-v-ba763c26"]]);export{K as _};
