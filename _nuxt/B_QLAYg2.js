import{_ as z}from"./D81k5HQH.js";import{_ as H}from"./D5vIias4.js";import{_ as I}from"./5VFGI6mo.js";import{g as q,I as P,r as c,s as L,H as C,w as M,o as r,T as S,c as v,z as U,a as e,y as V,A as $,B as y,C as T,t as x,d as B,J as j,j as E,b as k,m,E as A,F as O}from"#entry";import{_ as D}from"./DlAUqK2U.js";import{u as R}from"./C88IWbDi.js";const W={class:"window"},J={class:"input-group"},X=["disabled"],G={class:"input-group"},K=["disabled"],Q={class:"input-group"},Y=["disabled"],Z=["disabled"],ee={key:0},se={key:1,class:"loader"},te=q({__name:"ModalCatalogComponent",props:{modelValue:{default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(w){const p=P(w,"modelValue"),u=c(""),d=c(""),o=c(""),s=c(""),l=c(!1),a=c(!1),i=c(!1),b=L(()=>u.value.trim().length>=2&&d.value.replace(/\D/g,"").length>=11&&o.value.trim().length>=2),g=f=>{let n=f.target.value.replace(/\D/g,"");(n.startsWith("7")||n.startsWith("8"))&&(n=n.substring(1)),n.length>0&&(n="+7 "+n.substring(0,10).replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,"($1) $2-$3-$4").replace(/(\d{3})(\d{3})(\d{2})/,"($1) $2-$3").replace(/(\d{3})(\d{3})/,"($1) $2").replace(/(\d{3})/,"($1")),d.value=n},_=()=>{p.value=!1,F()},F=()=>{setTimeout(()=>{u.value="",d.value="",o.value="",s.value="",l.value=!1,a.value=!1,i.value=!1},300)},N=async()=>{if(!(!b.value||l.value)){l.value=!0,s.value="",a.value=!1,i.value=!1;try{const f=d.value.replace(/\D/g,"").replace(/^7/,""),t=await $fetch("/api/orders/call",{method:"POST",body:{name:u.value.trim(),phone:f,question:o.value.trim()}});a.value=t.ok,i.value=!t.ok,s.value=t.message,t.ok?setTimeout(()=>{_()},3e3):setTimeout(()=>{s.value="",i.value=!1},5e3)}catch{i.value=!0,s.value="Ошибка отправки. Попробуйте позже.",setTimeout(()=>{s.value="",i.value=!1},5e3)}finally{l.value=!1}}};return(f,t)=>{const n=I;return r(),C(n,null,{default:M(()=>[(r(),C(S,{to:"body"},[p.value?(r(),v("div",{key:0,class:"windowpos",onClick:V(_,["self"])},[e("div",W,[e("div",{class:"window-header"},[t[3]||(t[3]=e("p",{class:"form"},"Форма обратной связи",-1)),e("button",{class:"close-btn",onClick:_,"aria-label":"Закрыть"}," × ")]),e("form",{onSubmit:V(N,["prevent"]),class:"form-container"},[e("div",J,[$(e("input",{class:"name",type:"text",id:"name",name:"name","onUpdate:modelValue":t[0]||(t[0]=h=>u.value=h),required:"",placeholder:"Ваше имя",disabled:l.value},null,8,X),[[y,u.value]])]),e("div",G,[$(e("input",{class:"phone",type:"tel",id:"phone",name:"phone","onUpdate:modelValue":t[1]||(t[1]=h=>d.value=h),required:"",placeholder:"+7 (___) ___-__-__",disabled:l.value,onInput:g},null,40,K),[[y,d.value]])]),e("div",Q,[$(e("input",{class:"question",type:"text",id:"question",name:"question","onUpdate:modelValue":t[2]||(t[2]=h=>o.value=h),required:"",placeholder:"Вопрос о товаре",disabled:l.value},null,8,Y),[[y,o.value]])]),e("button",{type:"submit",class:T(["butwindow",{"butwindow--loading":l.value}]),disabled:l.value||!b.value},[l.value?(r(),v("span",se)):(r(),v("span",ee,"отправить запрос"))],10,Z),e("p",{class:T(["mess",{"mess--success":a.value,"mess--error":i.value}])},x(s.value),3),t[4]||(t[4]=e("div",{class:"contacts-info"},[e("a",{href:"mailto:sales@zmkural.com",class:"info"},"sales@zmkural.com"),e("p",{class:"privacy"},[B(" Нажимая кнопку, вы соглашаетесь с "),e("a",{href:"/privacy",target:"_blank",class:"privacy-link"},"политикой конфиденциальности")])],-1))],32)])])):U("",!0)]))]),_:1})}}}),ae=D(te,[["__scopeId","data-v-c1b8f3c9"]]),le={class:"catalogall"},oe={class:"catalog"},ne={class:"image-container"},ie={class:"product-info"},ue={class:"opora"},de={class:"titleproduct"},ce={class:"detailet"},re={class:"description-container"},pe=["innerHTML"],me={key:1,class:"no-description"},_e=q({__name:"[name]",async setup(w){let p,u;const d=j(),o=c(!1),{data:s}=([p,u]=E(()=>R(`/api/products/${d.params.name}`,"$gXHH-BcFmP")),p=await p,u(),p);return s.value?.html&&(s.value.html=s.value.html.split("<table").join('<div class="table-responsive"><table').split("</table>").join("</table></div>")),(l,a)=>{const i=z,b=H,g=ae;return r(),v(O,null,[e("div",le,[k(i,{to:"/catalog",class:"buttonback"},{default:M(()=>a[2]||(a[2]=[B(" ← Вернуться назад ")])),_:1}),e("div",oe,[e("div",ne,[k(b,{sizes:"(max-width: 768px) 300px, 400px",src:m(s)?.img,alt:m(s)?.name,class:"product-image"},null,8,["src","alt"])]),e("div",ie,[e("h1",ue,x(m(s)?.name),1),e("p",de,x(m(s)?.title),1)])]),e("div",ce,[a[3]||(a[3]=e("h2",{class:"section-title"},"подробное описание",-1)),e("button",{onClick:a[0]||(a[0]=_=>o.value=!0),class:"buttons"}," Задать вопрос о товаре ")]),e("div",re,[m(s)?.html?(r(),v("div",{key:0,innerHTML:m(s).html},null,8,pe)):(r(),v("div",me," Описание товара отсутствует "))])]),k(g,{modelValue:m(o),"onUpdate:modelValue":a[1]||(a[1]=_=>A(o)?o.value=_:null)},null,8,["modelValue"])],64)}}}),ye=D(_e,[["__scopeId","data-v-b16539c2"]]);export{ye as default};
